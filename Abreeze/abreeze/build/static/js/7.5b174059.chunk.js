(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{628:function(t,e){},653:function(t,e,n){},715:function(t,e,n){"use strict";n.r(e);n(231);var a,i,r,s,o=n(201),l=(n(51),n(20)),c=(n(54),n(39)),u=n(102),h=(n(224),n(179)),f=n(11),m=n(12),p=n(14),d=n(13),g=n(15),v=n(0),y=n.n(v),b=n(23),E=n(624),C=n.n(E),O=(n(629),n(653),n(35)),j=n(28),k=n(87),L=(n(109),n(66)),w=(n(40),n(4)),I=(n(143),n(68)),R=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(p.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(i)))).state={list:[],inputVisible:!1,inputValue:""},n.handleClose=function(t){var e=n.state.list.filter(function(e){return e!==t});n.setState({list:e})},n.showInput=function(){n.setState({inputVisible:!0},function(){return n.input.focus()})},n.handleInputChange=function(t){n.setState({inputValue:t.target.value})},n.handleInputConfirm=function(){var t=n.state,e=t.inputValue,a=t.list,i=n.props.CommonlyList;!e||a.includes(e)||i.includes(e)||(a=[].concat(Object(k.a)(a),[e])),n.setState({list:a,inputVisible:!1,inputValue:""})},n.saveInputRef=function(t){return n.input=t},n}return Object(g.a)(e,t),Object(m.a)(e,[{key:"render",value:function(){var t=this,e=this.state,n=e.list,a=e.inputVisible,i=e.inputValue;return y.a.createElement(v.Fragment,null,n.map(function(e,n){var a=e.length>20,i=y.a.createElement(L.a,{key:e,closable:!0,afterClose:function(){return t.handleClose(e)},color:"#1890ff"},a?"".concat(e.slice(0,20),"..."):e);return a?y.a.createElement(I.a,{title:e,key:e},i):i}),a&&y.a.createElement(c.a,{ref:this.saveInputRef,type:"text",size:"small",style:{width:78},value:i,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!a&&y.a.createElement(L.a,{onClick:this.showInput,style:{background:"#fff",borderStyle:"dashed"}},y.a.createElement(w.a,{type:"plus"})," New Tag"))}}]),e}(v.Component),S=L.a.CheckableTag,N=Object(b.b)(function(t){return t.article})((r=i=function(t){function e(t){var n;Object(f.a)(this,e),(n=Object(p.a)(this,Object(d.a)(e).call(this,t))).getCommonlyList=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return t.sort(function(t,e){return e.count-t.count}).map(function(t){return t.name}).slice(0,e)},n.handleSelect=function(t,e){var a=n.state.selectList,i=e?[].concat(Object(k.a)(a),[t]):a.filter(function(e){return e!==t});n.setState({selectList:i})},n.getResult=function(){var t=n.state.selectList,e=n.$selfCateRef.state.list;return[].concat(Object(k.a)(t),Object(k.a)(e))};var a,i=n.props,r=i.type,s=i.showNum;return n.props.isEdit||(n.CommonlyList=n.getCommonlyList(n.props["".concat(r,"List")],s),a=n.CommonlyList[0]?[n.CommonlyList[0]]:[]),n.state={selectList:a},n}return Object(g.a)(e,t),Object(m.a)(e,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this)}},{key:"componentWillReceiveProps",value:function(t){this.props.list!==t.list&&t.isEdit&&this.setState({selectList:t.list})}},{key:"render",value:function(){var t=this,e=this.state.selectList,n=this.props,a=n.type,i=n.isEdit;return y.a.createElement("div",{className:"blog-formItem"},y.a.createElement("span",{className:"label"},a,": "),i?this.props.list.map(function(n,a){return y.a.createElement(S,{key:n,checked:e.includes(n),onChange:function(e){return t.handleSelect(n,e)}},n)}):this.CommonlyList.map(function(n,a){return y.a.createElement(S,{key:n,checked:e.includes(n),onChange:function(e){return t.handleSelect(n,e)}},n)}),y.a.createElement(R,{CommonlyList:this.props.list,ref:function(e){return t.$selfCateRef=e}}))}}]),e}(v.Component),i.defaultProps={type:"tags",showNum:10},a=r))||a,V=Object(b.b)(function(t){return t.article})(s=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(p.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(i)))).state={value:"",title:"",tagList:[],categoryList:[],isEdit:!1},n.getCommonlyList=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return t.sort(function(t,e){return e.count-t.count}).slice(0,e)},n.handleSubmit=function(){var t=n.$tagRef.getResult(),e=n.$categoryRef.getResult(),a={title:n.state.title,content:n.smde.value(),categories:e,tags:t};if(n.state.isEdit){var i=localStorage.getItem("token");Object(j.a)({url:"/article/"+n.state.articleId,method:"put",data:a,headers:{Authorization:" JWT "+i}}).then(function(t){h.a.confirm({title:"\u6587\u7ae0\u4fee\u6539\u6210\u529f\uff01\u662f\u5426\u67e5\u770b\u8be6\u60c5\uff1f",onOk:function(){return n.props.history.push("/article/".concat(n.state.articleId))}})})}else{var r=localStorage.getItem("token");Object(j.a)({url:"/article",method:"post",data:a,headers:{Authorization:" JWT "+r}}).then(function(t){h.a.confirm({title:"\u6587\u7ae0\u521b\u5efa\u6210\u529f\uff01\u662f\u5426\u7acb\u5373\u67e5\u770b\uff1f",onOk:function(){return n.props.history.push("/article/".concat(t.id))}})})}},n.handleUpdate=function(){},n.handleChange=function(t){n.setState(Object(u.a)({},t.target.name,t.target.value))},n}return Object(g.a)(e,t),Object(m.a)(e,[{key:"componentDidMount",value:function(){var t=this;if(this.smde=new C.a({element:document.getElementById("editor").childElementCount,autofocus:!0,autosave:!0,previewRender:O.e}),this.props.history.location.state){var e=this.props.history.location.state.articleId;j.a.get("/article/".concat(e)).then(function(n){var a=n.title,i=n.tags,r=n.categories,s=n.content;t.smde.value(s);var o=i.map(function(t){return t.name}),l=r.map(function(t){return t.name});t.setState({title:a,tagList:o,categoryList:l,isEdit:!0,articleId:e})})}}},{key:"render",value:function(){var t=this,e=this.state,n=e.title,a=e.value,i=e.categoryList,r=e.tagList,s=e.isEdit;return y.a.createElement("div",{className:"edit"},y.a.createElement("div",{className:"blog-formItem"},y.a.createElement("span",{className:"label"},"\u6807\u9898\uff1a"),y.a.createElement(c.a,{placeholder:"\u8bf7\u8f93\u5165\u6587\u7ae0\u6807\u9898",className:"title-input",name:"title",value:n,onChange:this.handleChange})),y.a.createElement(N,{type:"category",showNum:10,onRef:function(e){return t.$categoryRef=e},list:i,isEdit:s}),y.a.createElement(N,{type:"tag",showNum:12,onRef:function(e){return t.$tagRef=e},list:r,isEdit:s}),y.a.createElement("br",null),y.a.createElement("textarea",{id:"editor",defaultValue:a}),y.a.createElement(l.a,{onClick:this.handleSubmit,type:"primary"},s?"\u66f4\u65b0":"\u521b\u5efa"),y.a.createElement(o.a,null))}}]),e}(v.Component))||s;e.default=V}}]);
//# sourceMappingURL=7.5b174059.chunk.js.map